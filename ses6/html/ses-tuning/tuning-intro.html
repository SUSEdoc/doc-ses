<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>Introduction to Tuning SUSE Enterprise Storage Clusters | Tuning Guide | SUSE Enterprise Storage 6</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Introduction to Tuning SUSE Enterprise Storage Cluster…"/>
<meta name="description" content="Tuning a distributed cluster is a foray into the use of the scientific method, backed with iterative testing. By taking a holistic look at the cluster and then…"/>
<meta name="product-name" content="SUSE Enterprise Storage"/>
<meta name="product-number" content="6"/>
<meta name="book-title" content="Tuning Guide"/>
<meta name="chapter-title" content="Chapter 3. Introduction to Tuning SUSE Enterprise Storage Clusters"/>
<meta name="tracker-url" content="https://github.com/SUSE/doc-ses/issues/new/choose"/>
<meta name="tracker-type" content="gh"/>
<meta name="tracker-gh-assignee" content="asettle"/>
<meta name="tracker-gh-labels" content="bug,question,feature request"/>
<meta property="og:title" content="Introduction to Tuning SUSE Enterprise Storage Cluster…"/>
<meta property="og:description" content="Tuning a distributed cluster is a foray into the use of the scientific method, backed with iterative testing. By taking a holistic look at the cluster and then…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Introduction to Tuning SUSE Enterprise Storage Cluster…"/>
<meta name="twitter:description" content="Tuning a distributed cluster is a foray into the use of the scientific method, backed with iterative testing. By taking a holistic look at the cluster and then…"/>
<link rel="prev" href="tuning-how.html" title="Chapter 2. General Notes on System Tuning"/><link rel="next" href="part-tuning-guide.html" title="Part II. SUSE Enterprise Storage Tuning"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Tuning Guide</a><span> / </span><a class="crumb" href="part-intro.html">Introduction</a><span> / </span><a class="crumb" href="tuning-intro.html">Introduction to Tuning SUSE Enterprise Storage Clusters</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Tuning Guide</div><ol><li class="active"><a href="part-intro.html" class="has-children you-are-here"><span class="title-number">I </span><span class="title-name">Introduction</span></a><ol><li><a href="bk03pt01ch01.html" class=" "><span class="title-number">1 </span><span class="title-name">User Privileges and Command Prompts</span></a></li><li><a href="tuning-how.html" class=" "><span class="title-number">2 </span><span class="title-name">General Notes on System Tuning</span></a></li><li><a href="tuning-intro.html" class=" you-are-here"><span class="title-number">3 </span><span class="title-name">Introduction to Tuning SUSE Enterprise Storage Clusters</span></a></li></ol></li><li><a href="part-tuning-guide.html" class="has-children "><span class="title-number">II </span><span class="title-name">SUSE Enterprise Storage Tuning</span></a><ol><li><a href="tuning-architecture.html" class=" "><span class="title-number">4 </span><span class="title-name">Architecture and Hardware Tuning</span></a></li><li><a href="tuning-os.html" class=" "><span class="title-number">5 </span><span class="title-name">Operating System Level Tuning</span></a></li><li><a href="tuning-ceph.html" class=" "><span class="title-number">6 </span><span class="title-name">Ceph Tuning</span></a></li><li><a href="cha-ceph-tiered.html" class=" "><span class="title-number">7 </span><span class="title-name">Cache Tiering</span></a></li><li><a href="lvmcache.html" class=" "><span class="title-number">8 </span><span class="title-name">Improving Performance with LVM cache</span></a></li></ol></li><li><a href="tuning-appendix-a.html" class=" "><span class="title-number">A </span><span class="title-name">Salt State for Kernel Tuning</span></a></li><li><a href="tuning-appendix-b.html" class=" "><span class="title-number">B </span><span class="title-name">Ring Buffer Max Value Script</span></a></li><li><a href="tuning-appendix-c.html" class=" "><span class="title-number">C </span><span class="title-name">Network Tuning</span></a></li><li><a href="bk03apd.html" class=" "><span class="title-number">D </span><span class="title-name">Ceph Maintenance Updates Based on Upstream 'Nautilus' Point Releases</span></a></li><li><a href="bk03go01.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="tuning-intro" data-id-title="Introduction to Tuning SUSE Enterprise Storage Clusters"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Enterprise Storage</span> <span class="productnumber">6</span></div><div><h2 class="title"><span class="title-number">3 </span><span class="title-name">Introduction to Tuning SUSE Enterprise Storage Clusters</span> <a title="Permalink" class="permalink" href="tuning-intro.html#">#</a></h2></div></div></div><p>
  Tuning a distributed cluster is a foray into the use of the scientific
  method, backed with iterative testing. By taking a holistic look at the
  cluster and then delving into all the components, it is possible to achieve
  dramatic improvements. Over the course of the work that contributed to the
  authoring of this guide, the authors have seen performance more than double
  in some specific cases.
 </p><p>
  This guide is intended to assist the reader in understanding the what and how
  of tuning a SUSE Enterprise Storage cluster. There are topics that are beyond the scope
  of this guide, and it is expected that there are further tweaks that may be
  performed to an individual cluster in order to achieve optimum performance in
  a particular end user environment.
 </p><p>
  This reference guide is targeted at architects and administrators who need to
  tune their SUSE Enterprise Storage cluster for optimal performance. Familiarity with
  Linux and Ceph are assumed.
 </p><section class="sect1" id="tuning-philosophy" data-id-title="Philosophy of Tuning"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">3.1 </span><span class="title-name">Philosophy of Tuning</span> <a title="Permalink" class="permalink" href="tuning-intro.html#tuning-philosophy">#</a></h2></div></div></div><p>
   Tuning requires looking at the entire system being tuned and approaching the
   process with scientific rigor. An exhaustive approach requires taking an
   initial baseline and altering a single variable at a time, measuring the
   result, and then reverting it back to default while moving on to the next
   tuning parameter. At the end of that process, it is then possible to examine
   the results, whether it be increased throughput, reduced latency, reduced
   CPU consumption, and then decide which are likely candidates for combining
   for additive benefit. This second phase should also be iterated through in
   the same fashion as the first. This general process would be continued until
   all possible combinations were tried and the optimal settings discovered.
  </p><p>
   Unfortunately, few have the time to perform such an exhaustive effort. This
   being reality, it is possible to utilize some knowledge and begin an
   iterative process of combining and measuring well-known candidates for
   performance improvements and measuring the resulting changes. That is the
   process followed during the research that produced this work.
  </p></section><section class="sect1" id="tuning-process" data-id-title="The Process"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">3.2 </span><span class="title-name">The Process</span> <a title="Permalink" class="permalink" href="tuning-intro.html#tuning-process">#</a></h2></div></div></div><p>
   A proper process is required for effective tuning to occur. The tenets of
   this process are:
  </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.5.2.4.7.3.1"><span class="term">Measure</span></dt><dd><p>
      Start with a baseline and measure the same way after each iteration. Make
      sure you are measuring all relevant dimensions. Discovering that you are
      CPU-bound only after working through multiple iterations invalidates all
      the time spent on the iterations.
     </p></dd><dt id="id-1.5.2.4.7.3.2"><span class="term">Document</span></dt><dd><p>
      Document all results for future analysis. Patterns may not be evident
      until later review.
     </p></dd><dt id="id-1.5.2.4.7.3.3"><span class="term">Discuss</span></dt><dd><p>
      When possible, discuss the results you are seeing with others for their
      insights and feedback.
     </p></dd><dt id="id-1.5.2.4.7.3.4"><span class="term">Repeat</span></dt><dd><p>
      A single measurement is not a guarantee of repeatability. Performing the
      same test multiple times helps to better establish an outcome.
     </p></dd><dt id="id-1.5.2.4.7.3.5"><span class="term">Isolate variables</span></dt><dd><p>
      Having only a single change affect the environment at a time may cause
      the process to be longer, but it also helps validate the particular
      adjustment being tested.
     </p></dd></dl></div></section><section class="sect1" id="tuning-hardware-software" data-id-title="Hardware and Software"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">3.3 </span><span class="title-name">Hardware and Software</span> <a title="Permalink" class="permalink" href="tuning-intro.html#tuning-hardware-software">#</a></h2></div></div></div><p>
   This work leveraged for SUSE Enterprise Storage was performed on two models of
   servers. Any results referenced in this guide are from this specific
   hardware environment. Variations of the environment can and will have an
   effect on the results.
  </p><p>
   Storage nodes:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     2U Server
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       1x Intel Skylake 6124
      </p></li><li class="listitem"><p>
       96 GB RAM
      </p></li><li class="listitem"><p>
       Mellanox Dual Port ConnectX-4 100 GbE
      </p></li><li class="listitem"><p>
       12x Intel SSD D3-S4510 960 GB
      </p></li><li class="listitem"><p>
       RAID-1 480 GB M.2 Boot Device
      </p></li></ul></div></li></ul></div><p>
   Admin, monitor, and protocol gateways:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     1U Server
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       1x Intel Skylake 4112
      </p></li><li class="listitem"><p>
       32 GB RAM
      </p></li><li class="listitem"><p>
       Mellanox Dual Port ConnectX-4 100 GbE
      </p></li><li class="listitem"><p>
       RAID-1 480 GB M.2 Boot Device
      </p></li></ul></div></li></ul></div><p>
   Switches:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     2x 32-port 100 GbE
    </p></li></ul></div><p>
   Software:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     SUSE Enterprise Storage 5.5
    </p></li><li class="listitem"><p>
     SUSE Linux Enterprise Server 15 SP1
    </p></li></ul></div><div id="id-1.5.2.4.8.11" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><h6>Note</h6><p>
    Limited-use subscriptions are provided with SUSE Enterprise Storage as part of the
    subscription entitlement.
   </p></div><section class="sect2" id="id-1.5.2.4.8.12" data-id-title="Performance Metrics"><div class="titlepage"><div><div><h3 class="title"><span class="title-number">3.3.1 </span><span class="title-name">Performance Metrics</span> <a title="Permalink" class="permalink" href="tuning-intro.html#id-1.5.2.4.8.12">#</a></h3></div></div></div><p>
    The performance of storage is measured on two different, but related axes:
    <code class="literal">latency</code> and <code class="literal">throughput</code>. In some
    cases, one is more important than the other. An example of throughput being
    more important is that of backup use cases, where throughput is the most
    critical measurement and maximum performance is achieved with larger
    transfer sizes. Conversely, for a high-performance database, latency is the
    most important measurement.
   </p><p>
    <span class="emphasis"><em>Latency</em></span> is the time from when the request was made to
    when it was completed. This is usually measured in terms of milliseconds.
    This performance can be directly tied to CPU clock speed, the system bus,
    and device performance. <span class="emphasis"><em>Throughput</em></span> is the measure of
    an amount of data that can be written or retrieved within a particular time
    period. The measure is usually in MB/s and GB/s, or perhaps MiB/s and
    GiB/s.
   </p><p>
    A third measurement that is often referred to is <code class="literal">IOPS</code>.
    This stands for Input/output Operations Per Second. This measure is
    somewhat ambiguous as the result is reliant on the size of the I/O
    operation, what type (read/write), and details about the I/O pattern: fresh
    write, overwrite, random write, mix of reads and writes. While ambiguous,
    it is still a valid tool to use when measuring the changes in the
    performance of your storage environment. For example, it is possible to
    make adjustments that may not affect the latency of a single 4K sequential
    write operation, but would allow many more of the operations to happen in
    parallel, resulting in a change in throughput and IOPS.
   </p></section></section><section class="sect1" id="tuning-measurement" data-id-title="Determining What to Measure"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">3.4 </span><span class="title-name">Determining What to Measure</span> <a title="Permalink" class="permalink" href="tuning-intro.html#tuning-measurement">#</a></h2></div></div></div><p>
   When tuning an environment, it is important to understand the I/O that is
   being tuned for. By properly understanding the I/O pattern, it is then
   possible to match the tests to the environment, resulting in a close
   simulation of the environment.
  </p><p>
   Tools that can be useful for understanding the I/O patterns are:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     <code class="command">iostat</code>
    </p></li><li class="listitem"><p>
     <code class="command">blktrace</code>, <code class="command">blkparse</code>
    </p></li><li class="listitem"><p>
     <code class="command">systemtap (stap)</code>
    </p></li><li class="listitem"><p>
     <code class="command">dtrace</code>
    </p></li></ul></div><p>
   While discussing these tools is beyond the scope of this document, the
   information they can provide may be very helpful in understanding the I/O
   profile that needs to be tuned.
  </p><section class="sect2" id="id-1.5.2.4.9.6" data-id-title="Single Thread vs Aggregate IO"><div class="titlepage"><div><div><h3 class="title"><span class="title-number">3.4.1 </span><span class="title-name">Single Thread vs Aggregate IO</span> <a title="Permalink" class="permalink" href="tuning-intro.html#id-1.5.2.4.9.6">#</a></h3></div></div></div><p>
    Understanding the requirements of the workload in relation to whether it
    needs scale-up or scale-out performance is often a key to proper tuning as
    well, particularly when it comes to tuning the hardware architecture and to
    creating test scenarios that provide valid information regarding tuning for
    the application(s) in question.
   </p></section></section><section class="sect1" id="tuning-testing-tools-protocol" data-id-title="Testing Tools and Protocol"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">3.5 </span><span class="title-name">Testing Tools and Protocol</span> <a title="Permalink" class="permalink" href="tuning-intro.html#tuning-testing-tools-protocol">#</a></h2></div></div></div><p>
   Proper testing involves selection of the right tools. For most performance
   test cases, use of <code class="command">fio</code> is recommended, as it provides a
   vast array of options for constructing test cases. For some use cases, such
   as S3, it may be necessary to use alternative tools to test all phases of
   I/O.
  </p><p>
   Tools that are commonly used to simulate I/O are:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     <code class="command">fio</code>
    </p></li><li class="listitem"><p>
     <code class="command">iometer</code>
    </p></li></ul></div><p>
   When performing testing, it is imperative that sound practices be utilized.
   This involves:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Pre-conditioning the media.
    </p></li><li class="listitem"><p>
     Ensuring what you are measuring is what you intend to measure.
    </p></li><li class="listitem"><p>
     Validate that the results you see make sense.
    </p></li><li class="listitem"><p>
     Test each component individually and then in aggregate, one layer at a
     time.
    </p></li></ul></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="tuning-how.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 2 </span>General Notes on System Tuning</span></a> </div><div><a class="pagination-link next" href="part-tuning-guide.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Part II </span>SUSE Enterprise Storage Tuning</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="tuning-intro.html#tuning-philosophy"><span class="title-number">3.1 </span><span class="title-name">Philosophy of Tuning</span></a></span></li><li><span class="sect1"><a href="tuning-intro.html#tuning-process"><span class="title-number">3.2 </span><span class="title-name">The Process</span></a></span></li><li><span class="sect1"><a href="tuning-intro.html#tuning-hardware-software"><span class="title-number">3.3 </span><span class="title-name">Hardware and Software</span></a></span></li><li><span class="sect1"><a href="tuning-intro.html#tuning-measurement"><span class="title-number">3.4 </span><span class="title-name">Determining What to Measure</span></a></span></li><li><span class="sect1"><a href="tuning-intro.html#tuning-testing-tools-protocol"><span class="title-number">3.5 </span><span class="title-name">Testing Tools and Protocol</span></a></span></li></ul></div><div class="side-title">Give feedback</div><ul class="feedback" id="_give-feedback"><li><a id="_feedback-reportbug" href="#" rel="nofollow" target="_blank">Report an issue</a></li><li><a id="_feedback-editurl" href="https://github.com/SUSE/doc-ses/edit/maintenance/ses6/xml/tuning-intro.xml" rel="nofollow" target="_blank">Edit source document</a></li></ul><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>