<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>Ceph Manager modules | Administration and Operations Guide | SUSE Enterprise Storage 7.1</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Ceph Manager modules | SES 7.1"/>
<meta name="description" content="The architecture of the Ceph Manager (refer to Book “Deployment Guide”, Chapter 1 “SES and Ceph”, Section 1.2.3 “Ceph nodes and daemons” for a brief …"/>
<meta name="product-name" content="SUSE Enterprise Storage"/>
<meta name="product-number" content="7.1"/>
<meta name="book-title" content="Administration and Operations Guide"/>
<meta name="chapter-title" content="Chapter 29. Ceph Manager modules"/>
<meta name="tracker-url" content="https://github.com/SUSE/doc-ses/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="tracker-gh-assignee" content="tbazant"/>
<meta name="tracker-gh-template" content="&#10;     ### Type of report&#10;   - [ ] bug&#10;   - [ ] feature request&#10;&#10;### Source Document&#10;@@source@@&#10;&#10;### Summary&#10;&lt;!-- A clear and concise description of what the bug/feature request is. --&gt;&#10;&#10;### Steps To Reproduce&#10;&lt;!-- Steps to reproduce the behavior if you ran through steps in the document. --&gt;&#10;&#10;### Expected Results&#10;&lt;!-- A clear and concise description of what you expected to happen. --&gt;&#10;&#10;### Actual Results&#10;&lt;!-- Explain what actually happened if steps were executed, and if applicable, add screenshots to help explain your problem. --&gt;&#10;&#10;### Notes&#10;&lt;!-- Add any other context about the problem here. --&gt;&#10;&#10;    "/>
<meta name="tracker-gh-labels" content="bug,question,feature request"/>
<meta property="og:title" content="Ceph Manager modules | SES 7.1"/>
<meta property="og:description" content="The architecture of the Ceph Manager (refer to Book “Deployment Guide”, Chapter 1 “SES and Ceph”, Section 1.2.3 “Ceph nodes and daemons” for a brief …"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ceph Manager modules | SES 7.1"/>
<meta name="twitter:description" content="The architecture of the Ceph Manager (refer to Book “Deployment Guide”, Chapter 1 “SES and Ceph”, Section 1.2.3 “Ceph nodes and daemons” for a brief …"/>
<link rel="prev" href="cha-ceph-configuration.html" title="Chapter 28. Ceph cluster configuration"/><link rel="next" href="cha-storage-cephx.html" title="Chapter 30. Authentication with cephx"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Administration and Operations Guide</a><span> / </span><a class="crumb" href="part-cluster-configuration.html">Configuring a Cluster</a><span> / </span><a class="crumb" href="cha-mgr-modules.html">Ceph Manager modules</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Administration and Operations Guide</div><ol><li><a href="preface-admin.html" class=" "><span class="title-number"> </span><span class="title-name">About this guide</span></a></li><li><a href="part-dashboard.html" class="has-children "><span class="title-number">I </span><span class="title-name">Ceph Dashboard</span></a><ol><li><a href="dashboard-about.html" class=" "><span class="title-number">1 </span><span class="title-name">About the Ceph Dashboard</span></a></li><li><a href="dashboard-webui-general.html" class=" "><span class="title-number">2 </span><span class="title-name">Dashboard's Web user interface</span></a></li><li><a href="dashboard-user-mgmt.html" class=" "><span class="title-number">3 </span><span class="title-name">Manage Ceph Dashboard users and roles</span></a></li><li><a href="dashboard-cluster.html" class=" "><span class="title-number">4 </span><span class="title-name">View cluster internals</span></a></li><li><a href="dashboard-pools.html" class=" "><span class="title-number">5 </span><span class="title-name">Manage pools</span></a></li><li><a href="dashboard-rbds.html" class=" "><span class="title-number">6 </span><span class="title-name">Manage RADOS Block Device</span></a></li><li><a href="dash-webui-nfs.html" class=" "><span class="title-number">7 </span><span class="title-name">Manage NFS Ganesha</span></a></li><li><a href="dashboard-mds.html" class=" "><span class="title-number">8 </span><span class="title-name">Manage CephFS</span></a></li><li><a href="dashboard-ogw.html" class=" "><span class="title-number">9 </span><span class="title-name">Manage the Object Gateway</span></a></li><li><a href="dashboard-initial-configuration.html" class=" "><span class="title-number">10 </span><span class="title-name">Manual configuration</span></a></li><li><a href="dashboard-user-roles.html" class=" "><span class="title-number">11 </span><span class="title-name">Manage users and roles on the command line</span></a></li></ol></li><li><a href="part-cluster-operation.html" class="has-children "><span class="title-number">II </span><span class="title-name">Cluster Operation</span></a><ol><li><a href="ceph-monitor.html" class=" "><span class="title-number">12 </span><span class="title-name">Determine the cluster state</span></a></li><li><a href="storage-salt-cluster.html" class=" "><span class="title-number">13 </span><span class="title-name">Operational tasks</span></a></li><li><a href="cha-ceph-operating.html" class=" "><span class="title-number">14 </span><span class="title-name">Operation of Ceph services</span></a></li><li><a href="cha-deployment-backup.html" class=" "><span class="title-number">15 </span><span class="title-name">Backup and restore</span></a></li><li><a href="monitoring-alerting.html" class=" "><span class="title-number">16 </span><span class="title-name">Monitoring and alerting</span></a></li></ol></li><li><a href="part-storing-data.html" class="has-children "><span class="title-number">III </span><span class="title-name">Storing Data in a Cluster</span></a><ol><li><a href="cha-storage-datamgm.html" class=" "><span class="title-number">17 </span><span class="title-name">Stored data management</span></a></li><li><a href="ceph-pools.html" class=" "><span class="title-number">18 </span><span class="title-name">Manage storage pools</span></a></li><li><a href="cha-ceph-erasure.html" class=" "><span class="title-number">19 </span><span class="title-name">Erasure coded pools</span></a></li><li><a href="ceph-rbd.html" class=" "><span class="title-number">20 </span><span class="title-name">RADOS Block Device</span></a></li></ol></li><li><a href="part-accessing-data.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Accessing Cluster Data</span></a><ol><li><a href="cha-ceph-gw.html" class=" "><span class="title-number">21 </span><span class="title-name">Ceph Object Gateway</span></a></li><li><a href="cha-ceph-iscsi.html" class=" "><span class="title-number">22 </span><span class="title-name">Ceph iSCSI gateway</span></a></li><li><a href="cha-ceph-cephfs.html" class=" "><span class="title-number">23 </span><span class="title-name">Clustered file system</span></a></li><li><a href="cha-ses-cifs.html" class=" "><span class="title-number">24 </span><span class="title-name">Export Ceph data via Samba</span></a></li><li><a href="cha-ceph-nfsganesha.html" class=" "><span class="title-number">25 </span><span class="title-name">NFS Ganesha</span></a></li></ol></li><li><a href="part-integration-virt.html" class="has-children "><span class="title-number">V </span><span class="title-name">Integration with Virtualization Tools</span></a><ol><li><a href="cha-ceph-libvirt.html" class=" "><span class="title-number">26 </span><span class="title-name"><code class="systemitem">libvirt</code> and Ceph</span></a></li><li><a href="cha-ceph-kvm.html" class=" "><span class="title-number">27 </span><span class="title-name">Ceph as a back-end for QEMU KVM instance</span></a></li></ol></li><li class="active"><a href="part-cluster-configuration.html" class="has-children you-are-here"><span class="title-number">VI </span><span class="title-name">Configuring a Cluster</span></a><ol><li><a href="cha-ceph-configuration.html" class=" "><span class="title-number">28 </span><span class="title-name">Ceph cluster configuration</span></a></li><li><a href="cha-mgr-modules.html" class=" you-are-here"><span class="title-number">29 </span><span class="title-name">Ceph Manager modules</span></a></li><li><a href="cha-storage-cephx.html" class=" "><span class="title-number">30 </span><span class="title-name">Authentication with <code class="systemitem">cephx</code></span></a></li></ol></li><li><a href="bk02apa.html" class=" "><span class="title-number">A </span><span class="title-name">Ceph maintenance updates based on upstream 'Pacific' point releases</span></a></li><li><a href="bk02go01.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-mgr-modules" data-id-title="Ceph Manager modules"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Enterprise Storage</span> <span class="productnumber">7.1</span></div><div><h1 class="title"><span class="title-number">29 </span><span class="title-name">Ceph Manager modules</span> <a title="Permalink" class="permalink" href="cha-mgr-modules.html#">#</a></h1></div></div></div><p>
  The architecture of the Ceph Manager (refer to
  <span class="intraxref">Book “Deployment Guide”, Chapter 1 “SES and Ceph”, Section 1.2.3 “Ceph nodes and daemons”</span> for a brief introduction) allows
  extending its functionality via <span class="emphasis"><em>modules</em></span>, such as
  'dashboard' (see <a class="xref" href="part-dashboard.html" title="Part I. Ceph Dashboard">Part I, “Ceph Dashboard”</a>), 'prometheus' (see
  <a class="xref" href="monitoring-alerting.html" title="Chapter 16. Monitoring and alerting">Chapter 16, <em>Monitoring and alerting</em></a>), or 'balancer'.
 </p><p>
  To list all available modules, run:
 </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph mgr module ls
{
        "enabled_modules": [
                "restful",
                "status"
        ],
        "disabled_modules": [
                "dashboard"
        ]
}</pre></div><p>
  To enable or disable a specific module, run:
 </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph mgr module enable <em class="replaceable">MODULE-NAME</em></pre></div><p>
  For example:
 </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph mgr module disable dashboard</pre></div><p>
  To list the services that the enabled modules provide, run:
 </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph mgr services
{
        "dashboard": "http://myserver.com:7789/",
        "restful": "https://myserver.com:8789/"
}</pre></div><section class="sect1" id="mgr-modules-balancer" data-id-title="Balancer"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">29.1 </span><span class="title-name">Balancer</span> <a title="Permalink" class="permalink" href="cha-mgr-modules.html#mgr-modules-balancer">#</a></h2></div></div></div><p>
   The balancer module optimizes the placement group (PG) distribution across
   OSDs for a more balanced deployment. Although the module is activated by
   default, it is inactive. It supports the following two modes:
   <code class="literal">crush-compat</code> and <code class="literal">upmap</code>.
  </p><div id="id-1.4.8.3.12.3" data-id-title="Current Balancer Status and Configuration" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><h6>Tip: Current Balancer Status and Configuration</h6><p>
    To view the current balancer status and configuration information, run:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer status</pre></div></div><section class="sect2" id="mgr-balancer-crush-compat" data-id-title="The crush-compat mode"><div class="titlepage"><div><div><h3 class="title"><span class="title-number">29.1.1 </span><span class="title-name">The 'crush-compat' mode</span> <a title="Permalink" class="permalink" href="cha-mgr-modules.html#mgr-balancer-crush-compat">#</a></h3></div></div></div><p>
    In 'crush-compat' mode, the balancer adjusts the OSDs' reweight-sets to
    achieve improved distribution of the data. It moves PGs between OSDs,
    temporarily causing a <code class="literal">HEALTH_WARN</code> cluster state
    resulting from misplaced PGs.
   </p><div id="id-1.4.8.3.12.4.3" data-id-title="Mode Activation" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><h6>Tip: Mode Activation</h6><p>
     Although 'crush-compat' is the default mode, we recommend activating it
     explicitly:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer mode crush-compat</pre></div></div></section><section class="sect2" id="mgr-balancer-planning-executing" data-id-title="Planning and executing of data balancing"><div class="titlepage"><div><div><h3 class="title"><span class="title-number">29.1.2 </span><span class="title-name">Planning and executing of data balancing</span> <a title="Permalink" class="permalink" href="cha-mgr-modules.html#mgr-balancer-planning-executing">#</a></h3></div></div></div><p>
    Using the balancer module, you can create a plan for data balancing. You
    can then execute the plan manually, or let the balancer balance PGs
    continuously.
   </p><p>
    The decision whether to run the balancer in manual or automatic mode
    depends on several factors, such as the current data imbalance, cluster
    size, PG count, or I/O activity. We recommend creating an initial plan and
    executing it at a time of low I/O load in the cluster. The reason for this
    is that the initial imbalance will probably be considerable and it is a
    good practice to keep the impact on clients low. After an initial manual
    run, consider activating the automatic mode and monitor the rebalance
    traffic under normal I/O load. The improvements in PG distribution need to
    be weighed against the rebalance traffic caused by the balancer.
   </p><div id="id-1.4.8.3.12.5.4" data-id-title="Movable Fraction of Placement Groups (PGs)" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><h6>Tip: Movable Fraction of Placement Groups (PGs)</h6><p>
     During the process of balancing, the balancer module throttles PG
     movements so that only a configurable fraction of PGs is moved. The
     default is 5% and you can adjust the fraction, to 9% for example, by
     running the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph config set mgr target_max_misplaced_ratio .09</pre></div></div><p>
    To create and execute a balancing plan, follow these steps:
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Check the current cluster score:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer eval</pre></div></li><li class="step"><p>
      Create a plan. For example, 'great_plan':
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer optimize great_plan</pre></div></li><li class="step"><p>
      See what changes the 'great_plan' will entail:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer show great_plan</pre></div></li><li class="step"><p>
      Check the potential cluster score if you decide to apply the
      'great_plan':
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer eval great_plan</pre></div></li><li class="step"><p>
      Execute the 'great_plan' for one time only:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer execute great_plan</pre></div></li><li class="step"><p>
      Observe the cluster balancing with the <code class="command">ceph -s</code>
      command. If you are satisfied with the result, activate automatic
      balancing:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer on</pre></div><p>
      If you later decide to deactivate automatic balancing, run:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph balancer off</pre></div></li></ol></div></div><div id="id-1.4.8.3.12.5.7" data-id-title="Automatic Balancing without Initial Plan" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><h6>Tip: Automatic Balancing without Initial Plan</h6><p>
     You can activate automatic balancing without executing an initial plan. In
     such case, expect a potentially long running rebalancing of placement
     groups.
    </p></div></section></section><section class="sect1" id="mgr-modules-telemetry" data-id-title="Enabling the telemetry module"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">29.2 </span><span class="title-name">Enabling the telemetry module</span> <a title="Permalink" class="permalink" href="cha-mgr-modules.html#mgr-modules-telemetry">#</a></h2></div></div></div><p>
   The telemetry plugin sends the Ceph project anonymous data about the
   cluster in which the plugin is running.
  </p><p>
   This (opt-in) component contains counters and statistics on how the cluster
   has been deployed, the version of Ceph, the distribution of the hosts and
   other parameters which help the project to gain a better understanding of
   the way Ceph is used. It does not contain any sensitive data like pool
   names, object names, object contents, or host names.
  </p><p>
   The purpose of the telemetry module is to provide an automated feedback loop
   for the developers to help quantify adoption rates, tracking, or point out
   things that need to be better explained or validated during configuration to
   prevent undesirable outcomes.
  </p><div id="id-1.4.8.3.13.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><h6>Note</h6><p>
    The telemetry module requires the Ceph Manager nodes to have the ability to push
    data over HTTPS to the upstream servers. Ensure your corporate firewalls
    permit this action.
   </p></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     To enable the telemetry module:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph mgr module enable telemetry</pre></div><div id="id-1.4.8.3.13.6.1.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><h6>Note</h6><p>
      This command only enables you to view your data locally. This command
      does not share your data with the Ceph community.
     </p></div></li><li class="step"><p>
     To allow the telemetry module to start sharing data:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph telemetry on</pre></div></li><li class="step"><p>
     To disable telemetry data sharing:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph telemetry off</pre></div></li><li class="step"><p>
     To generate a JSON report that can be printed:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph telemetry show</pre></div></li><li class="step"><p>
     To add a contact and description to the report:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph config set mgr mgr/telemetry/contact John Doe john.doe@example.com
<code class="prompt user">cephuser@adm &gt; </code>ceph config set mgr mgr/telemetry/description 'My first Ceph cluster'</pre></div></li><li class="step"><p>
     The module compiles and sends a new report every 24 hours by default. To
     adjust this interval:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephuser@adm &gt; </code>ceph config set mgr mgr/telemetry/interval <em class="replaceable">HOURS</em></pre></div></li></ol></div></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-ceph-configuration.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 28 </span>Ceph cluster configuration</span></a> </div><div><a class="pagination-link next" href="cha-storage-cephx.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 30 </span>Authentication with <code class="systemitem">cephx</code></span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-mgr-modules.html#mgr-modules-balancer"><span class="title-number">29.1 </span><span class="title-name">Balancer</span></a></span></li><li><span class="sect1"><a href="cha-mgr-modules.html#mgr-modules-telemetry"><span class="title-number">29.2 </span><span class="title-name">Enabling the telemetry module</span></a></span></li></ul></div><div class="side-title">Give feedback</div><ul class="feedback" id="_give-feedback"><li><a id="_feedback-editurl" href="https://github.com/SUSE/doc-ses/edit/main/xml/manager_modules.xml" rel="nofollow" target="_blank">Edit source document</a></li></ul><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>