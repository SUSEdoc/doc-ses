<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>Ceph Admin Node HA Setup | Deployment Guide | SUSE Enterprise Storage 5.5 (SES 5 &amp; SES 5.5)</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Ceph Admin Node HA Setup | SES 5.5 (SES 5 &amp; SES 5.5)"/>
<meta name="description" content="Ceph admin node is a Ceph cluster node where the Salt master service is running. The admin node is a central point of the Ceph cluster because it manages the r…"/>
<meta name="product-name" content="SUSE Enterprise Storage"/>
<meta name="product-number" content="5.5 (SES 5 &amp; SES 5.5)"/>
<meta name="book-title" content="Deployment Guide"/>
<meta name="chapter-title" content="Chapter 3. Ceph Admin Node HA Setup"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="tbazant@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Enterprise Storage 5"/>
<meta property="og:title" content="Ceph Admin Node HA Setup | SES 5.5 (SES 5 &amp; SES 5.5)"/>
<meta property="og:description" content="Ceph admin node is a Ceph cluster node where the Salt master service is running. The admin node is a central point of the Ceph cluster because it manages the r…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ceph Admin Node HA Setup | SES 5.5 (SES 5 &amp; SES 5.5)"/>
<meta name="twitter:description" content="Ceph admin node is a Ceph cluster node where the Salt master service is running. The admin node is a central point of the Ceph cluster because it manages the r…"/>
<link rel="prev" href="storage-bp-hwreq.html" title="Chapter 2. Hardware Requirements and Recommendations"/><link rel="next" href="ses-deployment.html" title="Part II. Cluster Deployment and Upgrade"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Deployment Guide</a><span> / </span><a class="crumb" href="part-ses.html">SUSE Enterprise Storage</a><span> / </span><a class="crumb" href="cha-admin-ha.html">Ceph Admin Node HA Setup</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Deployment Guide</div><ol><li><a href="bk02pr01.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li class="active"><a href="part-ses.html" class="has-children you-are-here"><span class="title-number">I </span><span class="title-name">SUSE Enterprise Storage</span></a><ol><li><a href="cha-storage-about.html" class=" "><span class="title-number">1 </span><span class="title-name">SUSE Enterprise Storage 5.5 and Ceph</span></a></li><li><a href="storage-bp-hwreq.html" class=" "><span class="title-number">2 </span><span class="title-name">Hardware Requirements and Recommendations</span></a></li><li><a href="cha-admin-ha.html" class=" you-are-here"><span class="title-number">3 </span><span class="title-name">Ceph Admin Node HA Setup</span></a></li></ol></li><li><a href="ses-deployment.html" class="has-children "><span class="title-number">II </span><span class="title-name">Cluster Deployment and Upgrade</span></a><ol><li><a href="ceph-install-saltstack.html" class=" "><span class="title-number">4 </span><span class="title-name">Deploying with DeepSea/Salt</span></a></li><li><a href="cha-ceph-upgrade.html" class=" "><span class="title-number">5 </span><span class="title-name">Upgrading from Previous Releases</span></a></li><li><a href="cha-deployment-backup.html" class=" "><span class="title-number">6 </span><span class="title-name">Backing Up the Cluster Configuration</span></a></li><li><a href="ceph-deploy-ds-custom.html" class=" "><span class="title-number">7 </span><span class="title-name">Customizing the Default Configuration</span></a></li></ol></li><li><a href="additional-software.html" class="has-children "><span class="title-number">III </span><span class="title-name">Installation of Additional Services</span></a><ol><li><a href="cha-ceph-as-intro.html" class=" "><span class="title-number">8 </span><span class="title-name">Installation of Services to Access your Data</span></a></li><li><a href="cha-ceph-additional-software-installation.html" class=" "><span class="title-number">9 </span><span class="title-name">Ceph Object Gateway</span></a></li><li><a href="cha-ceph-as-iscsi.html" class=" "><span class="title-number">10 </span><span class="title-name">Installation of iSCSI Gateway</span></a></li><li><a href="cha-ceph-as-cephfs.html" class=" "><span class="title-number">11 </span><span class="title-name">Installation of CephFS</span></a></li><li><a href="cha-as-ganesha.html" class=" "><span class="title-number">12 </span><span class="title-name">Installation of NFS Ganesha</span></a></li><li><a href="cha-ses-cifs.html" class=" "><span class="title-number">13 </span><span class="title-name">Exporting Ceph Data via Samba</span></a></li></ol></li><li><a href="ap-deploy-docupdate.html" class=" "><span class="title-number">A </span><span class="title-name">Documentation Updates</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-admin-ha" data-id-title="Ceph Admin Node HA Setup"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Enterprise Storage</span> <span class="productnumber">5.5 (SES 5 &amp; SES 5.5)</span></div><div><h2 class="title"><span class="title-number">3 </span><span class="title-name">Ceph Admin Node HA Setup</span> <a title="Permalink" class="permalink" href="cha-admin-ha.html#">#</a></h2></div></div></div><p>
  <span class="emphasis"><em>Ceph admin node</em></span> is a Ceph cluster node where the
  Salt master service is running. The admin node is a central point of the Ceph
  cluster because it manages the rest of the cluster nodes by querying and
  instructing their Salt minion services. It usually includes other services as
  well, for example the openATTIC Web UI with the <span class="emphasis"><em>Grafana</em></span>
  dashboard backed by the <span class="emphasis"><em>Prometheus</em></span> monitoring toolkit.
 </p><p>
  In case of the Ceph admin node failure, you usually need to provide a new
  working hardware for the node and restore the complete cluster configuration
  stack from a recent backup. Such method is time consuming and causes cluster
  outage.
 </p><p>
  To prevent the Ceph cluster performance downtime caused by the admin node
  failure, we recommend to make use of the High Availability (HA) cluster for the Ceph
  admin node.
 </p><section class="sect1" id="admin-ha-architecture" data-id-title="Outline of the HA Cluster for Ceph Admin Node"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">3.1 </span><span class="title-name">Outline of the HA Cluster for Ceph Admin Node</span> <a title="Permalink" class="permalink" href="cha-admin-ha.html#admin-ha-architecture">#</a></h2></div></div></div><p>
   The idea of an HA cluster is that in case of one cluster node failure, the
   other node automatically takes over its role including the virtualized
   Ceph admin node. This way other Ceph cluster nodes do not notice that
   the Ceph admin node failed.
  </p><p>
   The minimal HA solution for the Ceph admin node requires the following
   hardware:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Two bare metal servers able to run SUSE Linux Enterprise with the High Availability extension and
     virtualize the Ceph admin node.
    </p></li><li class="listitem"><p>
     Two or more redundant network communication paths, for example via Network
     Device Bonding.
    </p></li><li class="listitem"><p>
     Shared storage to host the disk image(s) of the Ceph admin node virtual
     machine. The shared storage needs to be accessible form both servers. It
     can be for example an NFS export, a Samba share, or iSCSI target.
    </p></li></ul></div><p>
   Find more details on the cluster requirements at
   <a class="link" href="https://documentation.suse.com/sle-ha/12-SP5/single-html/SLE-HA-install-quick/#sec-ha-inst-quick-req" target="_blank">https://documentation.suse.com/sle-ha/12-SP5/single-html/SLE-HA-install-quick/#sec-ha-inst-quick-req</a>.
  </p><div class="figure" id="id-1.4.3.4.6.6"><div class="figure-contents"><div class="mediaobject"><a href="images/ceph_admin_ha1.png" target="_blank"><img src="images/ceph_admin_ha1.png" width="" alt="2-Node HA Cluster for Ceph Admin Node"/></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="title-number">Figure 3.1: </span><span class="title-name">2-Node HA Cluster for Ceph Admin Node </span><a title="Permalink" class="permalink" href="cha-admin-ha.html#id-1.4.3.4.6.6">#</a></h6></div></div></section><section class="sect1" id="admin-ha-cluster" data-id-title="Building HA Cluster with Ceph Admin Node"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">3.2 </span><span class="title-name">Building HA Cluster with Ceph Admin Node</span> <a title="Permalink" class="permalink" href="cha-admin-ha.html#admin-ha-cluster">#</a></h2></div></div></div><p>
   The following procedure summarizes the most important steps of building the
   HA cluster for virtualizing the Ceph admin node. For details, refer to the
   indicated links.
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Set up a basic 2-node HA cluster with shared storage as described in
     <a class="link" href="https://documentation.suse.com/sle-ha/12-SP5/single-html/SLE-HA-install-quick/#art-sleha-install-quick" target="_blank">https://documentation.suse.com/sle-ha/12-SP5/single-html/SLE-HA-install-quick/#art-sleha-install-quick</a>.
    </p></li><li class="step"><p>
     On both cluster nodes, install all packages required for running the KVM
     hypervisor and the <code class="systemitem">libvirt</code> toolkit as described in
     <a class="link" href="https://documentation.suse.com/sles/12-SP5/single-html/SLES-virtualization/#sec-vt-installation-kvm" target="_blank">https://documentation.suse.com/sles/12-SP5/single-html/SLES-virtualization/#sec-vt-installation-kvm</a>.
    </p></li><li class="step"><p>
     On the first cluster node, create a new KVM virtual machine (VM) making
     use of <code class="systemitem">libvirt</code> as described in
     <a class="link" href="https://documentation.suse.com/sles/12-SP5/single-html/SLES-virtualization/#sec-libvirt-inst-virt-install" target="_blank">https://documentation.suse.com/sles/12-SP5/single-html/SLES-virtualization/#sec-libvirt-inst-virt-install</a>.
     Use the preconfigured shared storage to store the disk images of the VM.
    </p></li><li class="step"><p>
     After the VM setup is complete, export its configuration to an XML file on
     the shared storage. Use the following syntax:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">root # </code>virsh dumpxml <em class="replaceable">VM_NAME</em> &gt; /path/to/shared/vm_name.xml</pre></div></li><li class="step"><p>
     Create a resource for the Admin Node VM. Refer to
     <a class="link" href="https://documentation.suse.com/sle-ha/12-SP5/single-html/SLE-HA-guide/#cha-conf-hawk2" target="_blank">https://documentation.suse.com/sle-ha/12-SP5/single-html/SLE-HA-guide/#cha-conf-hawk2</a>
     for general info on creating HA resources. Detailed info on creating
     resource for a KVM virtual machine is described in
     <a class="link" href="http://www.linux-ha.org/wiki/VirtualDomain_%28resource_agent%29" target="_blank">http://www.linux-ha.org/wiki/VirtualDomain_%28resource_agent%29</a>.
    </p></li><li class="step"><p>
     On the newly created VM guest, deploy the Ceph admin node including the
     additional services you need there. Follow relevant steps in
     <a class="xref" href="ceph-install-saltstack.html#ceph-install-stack" title="4.3. Cluster Deployment">Section 4.3, “Cluster Deployment”</a>. At the same time, deploy the
     remaining Ceph cluster nodes on the non-HA cluster servers.
    </p></li></ol></div></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="storage-bp-hwreq.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 2 </span>Hardware Requirements and Recommendations</span></a> </div><div><a class="pagination-link next" href="ses-deployment.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Part II </span>Cluster Deployment and Upgrade</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-admin-ha.html#admin-ha-architecture"><span class="title-number">3.1 </span><span class="title-name">Outline of the HA Cluster for Ceph Admin Node</span></a></span></li><li><span class="sect1"><a href="cha-admin-ha.html#admin-ha-cluster"><span class="title-number">3.2 </span><span class="title-name">Building HA Cluster with Ceph Admin Node</span></a></span></li></ul></div><div class="side-title">Give feedback</div><ul class="feedback" id="_give-feedback"><li><a id="_feedback-reportbug" href="#" rel="nofollow" target="_blank">Report an issue</a></li><li><a id="_feedback-editurl" href="https://github.com/SUSE/doc-ses/edit/maintenance/ses5/xml/deployment_admin_ha.xml" rel="nofollow" target="_blank">Edit source document</a></li></ul><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>