<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>Ceph Cluster Configuration | Administration Guide | SUSE Enterprise Storage 5.5 (SES 5 &amp; SES 5.5)</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Ceph Cluster Configuration | SES 5.5 (SES 5 &amp; SES 5.5)"/>
<meta name="description" content="This chapter provides a list of important Ceph cluster settings and their description. The settings are sorted by topic."/>
<meta name="product-name" content="SUSE Enterprise Storage"/>
<meta name="product-number" content="5.5 (SES 5 &amp; SES 5.5)"/>
<meta name="book-title" content="Administration Guide"/>
<meta name="chapter-title" content="Chapter 12. Ceph Cluster Configuration"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="tbazant@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Enterprise Storage 5"/>
<meta property="og:title" content="Ceph Cluster Configuration | SES 5.5 (SES 5 &amp; SES 5.5)"/>
<meta property="og:description" content="This chapter provides a list of important Ceph cluster settings and their description. The settings are sorted by topic."/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ceph Cluster Configuration | SES 5.5 (SES 5 &amp; SES 5.5)"/>
<meta name="twitter:description" content="This chapter provides a list of important Ceph cluster settings and their description. The settings are sorted by topic."/>
<link rel="prev" href="cha-ceph-tiered.html" title="Chapter 11. Cache Tiering"/><link rel="next" href="part-dataccess.html" title="Part III. Accessing Cluster Data"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Administration Guide</a><span> / </span><a class="crumb" href="part-operate.html">Operating a Cluster</a><span> / </span><a class="crumb" href="cha-ceph-configuration.html">Ceph Cluster Configuration</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Administration Guide</div><ol><li><a href="bk01pr01.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li><a href="part-cluster-managment.html" class="has-children "><span class="title-number">I </span><span class="title-name">Cluster Management</span></a><ol><li><a href="storage-salt-cluster.html" class=" "><span class="title-number">1 </span><span class="title-name">Salt Cluster Administration</span></a></li></ol></li><li class="active"><a href="part-operate.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Operating a Cluster</span></a><ol><li><a href="cha-ceph-operating.html" class=" "><span class="title-number">2 </span><span class="title-name">Introduction</span></a></li><li><a href="ceph-operating-services.html" class=" "><span class="title-number">3 </span><span class="title-name">Operating Ceph Services</span></a></li><li><a href="ceph-monitor.html" class=" "><span class="title-number">4 </span><span class="title-name">Determining Cluster State</span></a></li><li><a href="monitoring-alerting.html" class=" "><span class="title-number">5 </span><span class="title-name">Monitoring and Alerting</span></a></li><li><a href="cha-storage-cephx.html" class=" "><span class="title-number">6 </span><span class="title-name">Authentication with <code class="systemitem">cephx</code></span></a></li><li><a href="cha-storage-datamgm.html" class=" "><span class="title-number">7 </span><span class="title-name">Stored Data Management</span></a></li><li><a href="ceph-pools.html" class=" "><span class="title-number">8 </span><span class="title-name">Managing Storage Pools</span></a></li><li><a href="ceph-rbd.html" class=" "><span class="title-number">9 </span><span class="title-name">RADOS Block Device</span></a></li><li><a href="cha-ceph-erasure.html" class=" "><span class="title-number">10 </span><span class="title-name">Erasure Coded Pools</span></a></li><li><a href="cha-ceph-tiered.html" class=" "><span class="title-number">11 </span><span class="title-name">Cache Tiering</span></a></li><li><a href="cha-ceph-configuration.html" class=" you-are-here"><span class="title-number">12 </span><span class="title-name">Ceph Cluster Configuration</span></a></li></ol></li><li><a href="part-dataccess.html" class="has-children "><span class="title-number">III </span><span class="title-name">Accessing Cluster Data</span></a><ol><li><a href="cha-ceph-gw.html" class=" "><span class="title-number">13 </span><span class="title-name">Ceph Object Gateway</span></a></li><li><a href="cha-ceph-iscsi.html" class=" "><span class="title-number">14 </span><span class="title-name">Ceph iSCSI Gateway</span></a></li><li><a href="cha-ceph-cephfs.html" class=" "><span class="title-number">15 </span><span class="title-name">Clustered File System</span></a></li><li><a href="cha-ceph-nfsganesha.html" class=" "><span class="title-number">16 </span><span class="title-name">NFS Ganesha: Export Ceph Data via NFS</span></a></li></ol></li><li><a href="part-gui.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Managing Cluster with GUI Tools</span></a><ol><li><a href="ceph-oa.html" class=" "><span class="title-number">17 </span><span class="title-name">openATTIC</span></a></li></ol></li><li><a href="part-virt.html" class="has-children "><span class="title-number">V </span><span class="title-name">Integration with Virtualization Tools</span></a><ol><li><a href="cha-ceph-libvirt.html" class=" "><span class="title-number">18 </span><span class="title-name">Using <code class="systemitem">libvirt</code> with Ceph</span></a></li><li><a href="cha-ceph-kvm.html" class=" "><span class="title-number">19 </span><span class="title-name">Ceph as a Back-end for QEMU KVM Instance</span></a></li></ol></li><li><a href="part-troubleshooting.html" class="has-children "><span class="title-number">VI </span><span class="title-name">FAQs, Tips and Troubleshooting</span></a><ol><li><a href="storage-tips.html" class=" "><span class="title-number">20 </span><span class="title-name">Hints and Tips</span></a></li><li><a href="storage-faqs.html" class=" "><span class="title-number">21 </span><span class="title-name">Frequently Asked Questions</span></a></li><li><a href="storage-troubleshooting.html" class=" "><span class="title-number">22 </span><span class="title-name">Troubleshooting</span></a></li></ol></li><li><a href="gloss-storage-glossary.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="app-stage1-custom.html" class=" "><span class="title-number">A </span><span class="title-name">DeepSea Stage 1 Custom Example</span></a></li><li><a href="app-alerting-default.html" class=" "><span class="title-number">B </span><span class="title-name">Default Alerts for SUSE Enterprise Storage</span></a></li><li><a href="app-storage-manual-inst.html" class=" "><span class="title-number">C </span><span class="title-name">Example Procedure of Manual Ceph Installation</span></a></li><li><a href="ap-adm-docupdate.html" class=" "><span class="title-number">D </span><span class="title-name">Documentation Updates</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-ceph-configuration" data-id-title="Ceph Cluster Configuration"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Enterprise Storage</span> <span class="productnumber">5.5 (SES 5 &amp; SES 5.5)</span></div><div><h2 class="title"><span class="title-number">12 </span><span class="title-name">Ceph Cluster Configuration</span> <a title="Permalink" class="permalink" href="cha-ceph-configuration.html#">#</a></h2></div></div></div><p>
  This chapter provides a list of important Ceph cluster settings and their
  description. The settings are sorted by topic.
 </p><section class="sect1" id="ceph-config-runtime" data-id-title="Runtime Configuration"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">12.1 </span><span class="title-name">Runtime Configuration</span> <a title="Permalink" class="permalink" href="cha-ceph-configuration.html#ceph-config-runtime">#</a></h2></div></div></div><p>
   <a class="xref" href="storage-salt-cluster.html#ds-custom-cephconf" title="1.12. Adjusting ceph.conf with Custom Settings">Section 1.12, “Adjusting <code class="filename">ceph.conf</code> with Custom Settings”</a> describes how to make changes to the
   Ceph configuration file <code class="filename">ceph.conf</code>. However, the
   actual cluster behavior is determined not by the current state of the
   <code class="filename">ceph.conf</code> file but by the configuration of the running
   Ceph daemons, which is stored in memory.
  </p><p>
   You can query an individual Ceph daemon for a particular configuration
   setting using the <span class="emphasis"><em>admin socket</em></span> on the node where the
   daemon is running. For example, the following command gets the value of the
   <code class="option">osd_max_write_size</code> configuration parameter from daemon
   named <code class="literal">osd.0</code>:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephadm &gt; </code>ceph --admin-daemon /var/run/ceph/ceph-osd.0.asok \
config get osd_max_write_size
{
  "osd_max_write_size": "90"
}</pre></div><p>
   You can also <span class="emphasis"><em>change</em></span> the daemons' settings at runtime.
   Remember that this change is temporary and will be lost after the next
   daemon restart. For example, the following command changes the
   <code class="option">osd_max_write_size</code> parameter to '50' for all OSDs in the
   cluster:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">cephadm &gt; </code>ceph tell osd.* injectargs --osd_max_write_size 50</pre></div><div id="id-1.3.4.12.4.7" data-id-title="injectargs is Not Reliable" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><h6>Warning: <code class="command">injectargs</code> is Not Reliable</h6><p>
    Unfortunately, changing the cluster settings with the
    <code class="command">injectargs</code> command is not 100% reliable. If you need to
    be sure that the changed parameter is active, change it in the
    configuration files on all cluster nodes and restart all daemons in the
    cluster.
   </p></div></section><section class="sect1" id="config-osd-and-bluestore" data-id-title="Ceph OSD and BlueStore"><div class="titlepage"><div><div><h2 class="title"><span class="title-number">12.2 </span><span class="title-name">Ceph OSD and BlueStore</span> <a title="Permalink" class="permalink" href="cha-ceph-configuration.html#config-osd-and-bluestore">#</a></h2></div></div></div><section class="sect2" id="config-auto-cache-sizing" data-id-title="Automatic Cache Sizing"><div class="titlepage"><div><div><h3 class="title"><span class="title-number">12.2.1 </span><span class="title-name">Automatic Cache Sizing</span> <a title="Permalink" class="permalink" href="cha-ceph-configuration.html#config-auto-cache-sizing">#</a></h3></div></div></div><p>
    BlueStore can be configured to automatically resize its caches when
    <code class="option">tc_malloc</code> is configured as the memory allocator and the
    <code class="option">bluestore_cache_autotune</code> setting is enabled. This option
    is currently enabled by default. BlueStore will attempt to keep OSD heap
    memory usage under a designated target size via the
    <code class="option">osd_memory_target</code> configuration option. This is a best
    effort algorithm and caches will not shrink smaller than the amount
    specified by <code class="option">osd_memory_cache_min</code>. Cache ratios will be
    chosen based on a hierarchy of priorities. If priority information is not
    available, the <code class="option">bluestore_cache_meta_ratio</code> and
    <code class="option">bluestore_cache_kv_ratio</code> options are used as fallbacks.
   </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.3.4.12.5.2.3.1"><span class="term"><code class="option">bluestore_cache_autotune</code></span></dt><dd><p>
       Automatically tunes the ratios assigned to different BlueStore caches
       while respecting minimum values. Default is <code class="option">True</code>.
      </p></dd><dt id="id-1.3.4.12.5.2.3.2"><span class="term"><code class="option">osd_memory_target</code></span></dt><dd><p>
       When <code class="option">tc_malloc</code> and
       <code class="option">bluestore_cache_autotune</code> are enabled, try to keep this
       many bytes mapped in memory.
      </p><div id="id-1.3.4.12.5.2.3.2.2.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><h6>Note</h6><p>
        This may not exactly match the RSS memory usage of the process. While
        the total amount of heap memory mapped by the process should generally
        stay close to this target, there is no guarantee that the kernel will
        actually reclaim memory that has been unmapped.
       </p></div></dd><dt id="id-1.3.4.12.5.2.3.3"><span class="term"><code class="option">osd_memory_cache_min</code></span></dt><dd><p>
       When <code class="option">tc_malloc</code> and
       <code class="option">bluestore_cache_autotune</code> are enabled, set the minimum
       amount of memory used for caches.
      </p><div id="id-1.3.4.12.5.2.3.3.2.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><h6>Note</h6><p>
        Setting this value too low can result in significant cache thrashing.
       </p></div></dd></dl></div></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-ceph-tiered.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 11 </span>Cache Tiering</span></a> </div><div><a class="pagination-link next" href="part-dataccess.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Part III </span>Accessing Cluster Data</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-ceph-configuration.html#ceph-config-runtime"><span class="title-number">12.1 </span><span class="title-name">Runtime Configuration</span></a></span></li><li><span class="sect1"><a href="cha-ceph-configuration.html#config-osd-and-bluestore"><span class="title-number">12.2 </span><span class="title-name">Ceph OSD and BlueStore</span></a></span></li></ul></div><div class="side-title">Give feedback</div><ul class="feedback" id="_give-feedback"><li><a id="_feedback-reportbug" href="#" rel="nofollow" target="_blank">Report an issue</a></li><li><a id="_feedback-editurl" href="https://github.com/SUSE/doc-ses/edit/maintenance/ses5/xml/runtime_config.xml" rel="nofollow" target="_blank">Edit source document</a></li></ul><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>